-- GUI Instances
local MainGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local TitleLabel = Instance.new("TextLabel")
local ToggleButton = Instance.new("TextButton")
local CloseButton = Instance.new("TextButton")
local StatusLabel = Instance.new("TextLabel")

-- Parent the GUI to the game's PlayerGui
MainGui.Name = "AdvancedGUI"
MainGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

-- MainFrame Setup
MainFrame.Name = "MainFrame"
MainFrame.Parent = MainGui
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
MainFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
MainFrame.BorderSizePixel = 2
MainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
MainFrame.Size = UDim2.new(0, 350, 0, 200)

-- TitleLabel Setup
TitleLabel.Name = "TitleLabel"
TitleLabel.Parent = MainFrame
TitleLabel.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
TitleLabel.BorderSizePixel = 0
TitleLabel.Size = UDim2.new(1, 0, 0, 30)
TitleLabel.Font = Enum.Font.SourceSansBold
TitleLabel.Text = "Advanced GUI"
TitleLabel.TextColor3 = Color3.new(1, 1, 1)
TitleLabel.TextScaled = true

-- ToggleButton Setup
ToggleButton.Name = "ToggleButton"
ToggleButton.Parent = MainFrame
ToggleButton.BackgroundColor3 = Color3.fromRGB(85, 170, 255)
ToggleButton.Size = UDim2.new(0, 150, 0, 50)
ToggleButton.Position = UDim2.new(0.5, -75, 0.4, -25)
ToggleButton.Font = Enum.Font.SourceSans
ToggleButton.Text = "Turn On"
ToggleButton.TextColor3 = Color3.new(1, 1, 1)
ToggleButton.TextScaled = true
ToggleButton.AnchorPoint = Vector2.new(0.5, 0.5)

-- StatusLabel Setup
StatusLabel.Name = "StatusLabel"
StatusLabel.Parent = MainFrame
StatusLabel.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
StatusLabel.Size = UDim2.new(0, 200, 0, 30)
StatusLabel.Position = UDim2.new(0.5, -100, 0.75, -15)
StatusLabel.Font = Enum.Font.SourceSans
StatusLabel.Text = "Status: OFF"
StatusLabel.TextColor3 = Color3.new(1, 0, 0)
StatusLabel.TextScaled = true
StatusLabel.AnchorPoint = Vector2.new(0.5, 0.5)

-- CloseButton Setup
CloseButton.Name = "CloseButton"
CloseButton.Parent = MainFrame
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 85, 85)
CloseButton.Size = UDim2.new(0, 100, 0, 30)
CloseButton.Position = UDim2.new(1, -110, 1, -40)
CloseButton.Font = Enum.Font.SourceSansBold
CloseButton.Text = "Close"
CloseButton.TextColor3 = Color3.new(1, 1, 1)
CloseButton.TextScaled = true

-- Functionality: Toggle Button
local isOn = false
ToggleButton.MouseButton1Click:Connect(function()
    isOn = not isOn

    if isOn then
        ToggleButton.Text = "Turn Off"
        StatusLabel.Text = "Status: ON"
        StatusLabel.TextColor3 = Color3.new(0, 1, 0)
        print("Feature is now ON")
    else
        ToggleButton.Text = "Turn On"
        StatusLabel.Text = "Status: OFF"
        StatusLabel.TextColor3 = Color3.new(1, 0, 0)
        print("Feature is now OFF")
    end
end)

-- Functionality: Close Button
CloseButton.MouseButton1Click:Connect(function()
    MainGui:Destroy()
end)ToggleButton.Text = "Turn ON"
ToggleButton.TextColor3 = Color3.new(1, 1, 1)
ToggleButton.Font = Enum.Font.SourceSans
ToggleButton.TextSize = 24

-- Fungsi untuk menangani aksi saat loop aktif
local function fireEvent()
    while onPosition do
        -- RemoteEvent Call
        local success, err = pcall(function()
            game:GetService("ReplicatedStorage")
                :WaitForChild("1d89399b-fdf0-4dea-a9e6-eab9e790fe68")
                :WaitForChild("Events")
                :WaitForChild("") -- Ganti dengan nama valid!
                :FireServer(unpack(args))
        end)

        if not success then
            warn("Gagal memanggil RemoteEvent: " .. tostring(err))
        end

        -- Tunggu sebelum mengulang
        task.wait(0.1)
    end
end

-- Fungsi untuk mengatur tombol ON/OFF
ToggleButton.MouseButton1Click:Connect(function()
    onPosition = not onPosition -- Toggle posisi

    if onPosition then
        ToggleButton.Text = "Turn OFF"
        print("Loop dimulai.") -- Debug Log
        fireEvent() -- Mulai menjalankan loop
    else
        ToggleButton.Text = "Turn ON"
        print("Loop dihentikan.") -- Debug Log
        -- Loop akan berhenti karena kondisi `onPosition` sudah tidak `true`
    end
end)
